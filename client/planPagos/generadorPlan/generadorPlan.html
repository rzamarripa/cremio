<div class="row">
	<div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
		<h1 class="alge-title txt-color-blueDark">
			<i class="fa fa-list fa-fw "></i>
				Clientes &gt; Solicitud de Crédito
		</h1>
	</div>
</div>
<br>
<!-- Cabecera del perfil de  alumno seleccionado -->
<div class="row" ng-show="ge.cliente.profile != undefined">
	<div class="col-sm-12">
		<div class="well well-sm">
			<div class="row">
				<div class="col-sm-12 col-md-12 col-lg-12">
					<div class="well well-light well-sm no-margin no-padding">
						<div class="row">
							<div class="col-sm-12">
								<div id="myCarousel" class="carousel profile-carousel">
									<div class="air air-bottom-right padding-10">
										<a ng-if="currentUser.roles[0] == 'Gerente' || currentUser.roles[0] == 'Cajero' || currentUser.roles[0] == 'Verificador' " ui-sref="root.clienteDetalle({objeto_id : ge.cliente._id})" class="btn txt-color-white bg-color-teal btn-sm"><i class="fa fa-user"></i> Ir a mi perfil</a>&nbsp;
 										<a ui-sref="root.editarCliente({cliente_id : ge.cliente._id})" class="btn txt-color-white bg-color-pinkDark btn-sm" ng-show="currentUser.roles[0] == 'Gerente'">
	 										<i class="fa fa-pencil"></i> Modificar
	 									</a> 
									</div>
									<div class="air air-top-left padding-10">
										<h4 class="txt-color-white font-md"><i class="fa fa-calendar"></i>&nbsp;&nbsp;{{ge.fechaActual | date:'dd-MM-yyyy'}}</h4>
									</div>
									<ol class="carousel-indicators">
									</ol>
									<div class="carousel-inner">
										<div class="item active">
											<img src="img/demo/s1.jpg" alt="" style="width:100%">
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-12">
								<div class="row">
									<div class="col-sm-2 profile-pic" style="text-align:left;width:initial;">
										<img style="max-width:200px;" src="{{ge.tieneFoto(ge.cliente.profile.sexo, ge.cliente.profile.fotografia)}}" >
									</div>
									<div class="col-sm-6">
										<h1>{{ge.cliente.profile.nombre}} <span class="semi-bold">{{ge.cliente.profile.apellidoPaterno}} {{ge.cliente.profile.apellidoMaterno}}</span>
										
										<small> (Cliente)</small></h1>
										<ul class="list-unstyled">
											<li>
												<p class="text-muted">
													<i class="fa fa-key fa-lg"></i>&nbsp;&nbsp;
													<span class="txt-color-darken">
														<strong>{{ge.pago.username}}</strong>
													</span>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-phone fa-lg"></i>&nbsp;&nbsp;<span class="txt-color-darken">{{ge.cliente.profile.telefono}}</span>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-envelope fa-lg"></i>&nbsp;&nbsp;<a href="mailto:{{ge.cliente.profile.correo}}">{{ge.cliente.profile.correo}}</a>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-birthday-cake fa-lg"></i>&nbsp;&nbsp;<span class="txt-color-darken">{{ge.cliente.profile.fechaNacimiento | date:"dd-MM-yyyy"}}</span>
												</p>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12">
					<form name="formNuevoCredito" class="form-horizontal" role="form" novalidate>
				  	<div class="well">	    
					  	<div class="row">
					  		<div class="col-sm-12">
					  			<div class="alert alert-info">
					  			 <p><i class="fa-fw fa fa-info"></i> Para <strong>crear un nuevo crédito</strong> es importante que pongamos la información correcta.</p>
					  			 <p><strong>Revisar bien los datos.</strong></p>
					  			</div>
					  		</div>
					  	</div>
					    <div class="row">
						    <div class="col-sm-4" valida>
						    	<label>Tipo de crédito</label>
						    	<select name="tipoCreditoNuevo" class="form-control" ng-model="ge.credito.tipoCredito_id">
							    	<option value="{{tipoCredito._id}}" ng-repeat="tipoCredito in ge.tiposCredito">{{tipoCredito.nombre}}</option>
						    	</select>
					    	</div>
					    	<div class="col-sm-4" valida>
						    	<label>Periodo de pago *</label>
						    	<select name="periodoCreditoNuevo" class="form-control" ng-model="ge.credito.periodoPago">
							    	<option value="Semanal">Semanal</option>
							    	<option value="Mensual">Mensual</option>
						    	</select>
					    	</div>									    	
					    	<div class="col-sm-4" valida>					    
						    	<label>Duración (Meses) *</label>
						    	<input name="duracionMesesCreditoNuevo" type="number" class="form-control" placeholder="Duración en Meses" ng-model="ge.credito.duracionMeses" required="">
					    	</div>									    	
					    </div>
					    <div class="row">
					    	<div class="col-sm-3" valida>
						    	<label>Capital Solicitado *</label>
						    	<input name="capitalSolicitadoCreditoNuevo" type="number" class="form-control" placeholder="Capital Solicitado" ng-model="ge.credito.capitalSolicitado" required="">
					    	</div>
					    	<div class="col-sm-3" valida>
						    	<label>Primer abono *</label>
						    	<input date-time format="dd-MM-yyyy" class="form-control" view="date" max-view="year" min-view="date" ng-model="ge.credito.primerAbono" name="fechaPrimerAbono" required/>
					    	</div>
					    	<div class="col-sm-3">					    
						    	<label>Requiere Verificación</label>
						    	<input name="requiereVerificacionCreditoNuevo" type="checkbox" class="form-control" ng-model="ge.credito.requiereVerificacion">
					    	</div>
					    	<div class="col-sm-3" valida>
						    	<label>Fecha Verificación</label>
						    	<input name="fechaVerificacion" date-time format="dd-MM-yyyy" class="form-control" view="date" max-view="year" min-view="date" ng-model="ge.credito.fechaVerificacion" ng-disabled="!ge.credito.requiereVerificacion" />
					    	</div>

					    </div>
						</div>
						
						<h4>Avales</h4>
						
						<div class="well">	    
							<div class="row">
								<div class="col-sm-8"> 
									<!--<form class="header-search pull-right">
								    <div class="form-group" style="width: 800px;">-->
											<div ng-include=" 'client/planPagos/generadorPlan/_buscarPersona.html' "></div>
								  <!--  </div>	    
									</form>-->
								</div>
							</div>
					    <div class="row">
					    	<div class="col-sm-3"> 					    
						    	<label>Nombre</label>
						    	<input name="nombreAval" type="text" class="form-control" placeholder="Nombre" ng-model="ge.aval.nombre">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Apellido Paterno</label>
						    	<input name="apellidoPaternoAval" type="text" class="form-control" placeholder="Apellido Paterno" ng-model="ge.aval.apellidoPaterno">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Apellido Materno</label>
						    	<input name="apellidoMaternoAval" type="text" class="form-control" placeholder="Apellido Materno" ng-model="ge.aval.apellidoMaterno">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Estado Civil</label>
						    	<input name="estadoCivil" type="text" class="form-control" placeholder="Estado Civil" ng-model="ge.aval.estadoCivil">
					    	</div>
					    </div>
					    <div class="row">	
						    <div class="col-sm-3"> 					    
						    	<label>Ocupación</label>
						    	<input name="ocupacion" type="text" class="form-control" placeholder="Ocupación" ng-model="ge.aval.ocupacion">
					    	</div>
						    <div class="col-sm-4">					    
						    	<label>Dirección</label>
						    	<input name="direccion" type="text" class="form-control" placeholder="Dirección" ng-model="ge.aval.direccion">
					    	</div>
					    	<div class="col-sm-3">					    
						    	<label>Empresa</label>
						    	<input name="empresa" type="text" class="form-control" placeholder="Empresa" ng-model="ge.aval.empresa">
					    	</div>
					    	<div class="col-sm-2">					    
						    	<label>Puesto</label>
						    	<input name="puesto" type="text" class="form-control" placeholder="Puesto" ng-model="ge.aval.puesto">
					    	</div>
					    	
					    </div>
					    <div class="row">	
						    <div class="col-sm-2">					    
						    	<label>Antiguedad</label>
						    	<input name="antiguedad" type="text" class="form-control" placeholder="Antiguedad" ng-model="ge.aval.antiguedad">
					    	</div>
						    <div class="col-sm-4">					    
						    	<label>Dirección Empresa</label>
						    	<input name="direccionEmpresa" type="text" class="form-control" placeholder="Dirección Empresa" ng-model="ge.aval.direccionEmpresa">
					    	</div>
					    	<div class="col-sm-4">					    
						    	<label>Parentezco</label>
						    	<input name="parentezco" type="text" class="form-control" placeholder="Parentezco" ng-model="ge.aval.parentezco">
					    	</div>
					    	<div class="col-sm-2">					    
						    	<label>Tiempo de Conocerlo</label>
						    	<input name="tiempoConocerlo" type="text" class="form-control" placeholder="Tiempo en Conocerlo" ng-model="ge.aval.tiempoConocerlo">
					    	</div>
					    	<!--<input type="hidden" name="aval_id" ng-model="ge.aval._id" value="">-->
					    </div>
					    <div class="row">		
					    	<div class="col-sm-3">
							   	<input type="button" ng-click="ge.insertarAval()" value="Agregar" ng-show="ge.actionAval" class="btn btn-primary"> 	
							   	<input type="button" ng-click="ge.borrarReferencia()" value="Quitar Referenciado" ng-show="ge.aval.persona_id" class="btn btn-warning">
							   	<input type="button" ng-click="ge.actualizarAval(ge.aval)" value="Actualizar" ng-show="!ge.actionAval" class="btn btn-primary">
							   	<input type="button" ng-click="ge.cancelarAval()" value="Cancelar" ng-show="!ge.actionAval" class="btn btn-danger">	   				
								</div>
					    </div>
					    <br/>
					    <div class="row">
								<div class="col-sm-12">
									<table class="table table-bordered">
										<thead>
											<tr>
												<th width="5%">Número</th>
												<th width="15%">Nombre</th>
												<th width="5%">Estado Civil</th>
												<th width="5%">Ocupación</th>
												<th width="15%">Dirección</th>
												<th width="10%">Empresa</th>
												<th width="5%">Puesto</th>
												<th width="5%">Antiguedad</th>
												<th width="15%">Dirección Empresa</th>
												<th width="10%">Parentezco</th>
												<th width="10%">Tiempo Conocerlo</th>
												<th width="5%">Quitar</th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="aval in ge.avales">
												<td>{{aval.num}}</td>
												<td>{{aval.nombre}}</td>
												<td>{{aval.estadoCivil}}</td>
												<td>{{aval.ocupacion}}</td>
												<td>{{aval.direccion}}</td>
												<td>{{aval.empresa}}</td>
												<td>{{aval.puesto}}</td>
												<td>{{aval.antiguedad}}</td>
												<td>{{aval.direccionEmpresa}}</td>
												<td>{{aval.parentezco}}</td>
												<td>{{aval.tiempoConocerlo}}</td>
												<td>
														<a href="#" ng-click="ge.quitarAval(aval.num)"><i class="fa fa-trash"></i></a>
														<a href="#" ng-click="ge.editarAval(aval)"><i class="fa fa-pencil"></i></a>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
						
												
						<h4>Garantias</h4>
						<div class="well">	    
					    <div class="row">
					    	<div class="col-sm-4"> 					    
						    	<label>Tipo</label>
						    	<input name="tipo" type="text" class="form-control" placeholder="tipo" ng-model="ge.garantia.tipo">
					    	</div>
					    	<div class="col-sm-4"> 					    
						    	<label>Marca</label>
						    	<input name="marca" type="text" class="form-control" placeholder="Marca" ng-model="ge.garantia.marca">
					    	</div>
					    	<div class="col-sm-4"> 					    
						    	<label>Modelo</label>
						    	<input name="modelo" type="text" class="form-control" placeholder="Modelo" ng-model="ge.garantia.modelo">
					    	</div>
					    </div>
					    <div class="row">	
						    <div class="col-sm-4">					    
						    	<label>Serie</label>
						    	<input name="serie" type="text" class="form-control" placeholder="Serie" ng-model="ge.garantia.serie">
					    	</div>
					    	<div class="col-sm-4">					    
						    	<label>Color</label>
						    	<input name="color" type="text" class="form-control" placeholder="Color" ng-model="ge.garantia.color">
					    	</div>
					    	<div class="col-sm-4">					    
						    	<label>Estado Actual</label>
						    	<input name="estadoActual" type="text" class="form-control" placeholder="Estado Actual" ng-model="ge.garantia.estadoActual">
					    	</div>
					    </div>
					    <div class="row">		
					    	<div class="col-sm-3">
							   	<input type="button" ng-click="ge.insertarGarantia()" value="Agregar" ng-show="ge.actionGarantia" class="btn btn-primary"> 	
							   	<input type="button" ng-click="ge.actualizarGarantia(ge.garantia)" value="Actualizar" ng-show="!ge.actionGarantia" class="btn btn-primary">
							   	<input type="button" ng-click="ge.cancelarGarantia()" value="Cancelar" ng-show="!ge.actionGarantia" class="btn btn-danger">	   				
								</div>
					    </div>
					    <br/>
					    <div class="row">
								<div class="col-sm-12">
									<table class="table table-bordered">
										<thead>
											<tr>
												<th width="5%">Número</th>
												<th width="15%">Tipo</th>
												<th width="15%">Marca</th>
												<th width="15%">Modelo</th>
												<th width="15%">Serie</th>
												<th width="15%">Color</th>
												<th width="15%">Estado Actual</th>
												<th width="5%">Quitar</th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="garantia in ge.garantias">
												<td>{{garantia.num}}</td>
												<td>{{garantia.tipo}}</td>
												<td>{{garantia.marca}}</td>
												<td>{{garantia.modelo}}</td>
												<td>{{garantia.serie}}</td>
												<td>{{garantia.color}}</td>
												<td>{{garantia.estadoActual}}</td>
												<td>
														<a href="#" ng-click="ge.quitarGarantia(garantia.num)"><i class="fa fa-trash"></i></a>
														<a href="#" ng-click="ge.editarGarantia(garantia)"><i class="fa fa-pencil"></i></a>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>		 
						
						
						<div class="row">
							<div class="col-sm-12">
								<button class="btn btn-info" ng-click="ge.generarPlanPagos(ge.credito, formNuevoCredito)" valida-form formulario="formNuevoCredito">Calcular Plan de Pagos</button>
							</div>
						</div>	  
				  </form>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-sm-12" >
		<table class="table table-striped table-bordered table-condensed font-xs">
			<caption>
				<h4>Plan Nuevo</h4>
			</caption>
			<thead class="thead">
				<tr>
					<th class="text-center" width="5%">No.</th>
					<th class="text-center" width="20%">Fecha de Pago</th>
					<th class="text-center" width="15%">Pago</th>
					<th class="text-center" width="10%">Capital</th>
					<th class="text-center" width="10%">Interes</th>
					<th class="text-center" width="10%">IVA</th>
					<th class="text-center" width="10%">Importe total</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-class="( pago.estatus == 1 ) ? 'success' : ( pago.fecha < ge.fechaActual && pago.estatus == 0 ) ? 'warning' : ( pago.estatus == 2 ) ? 'danger' : 'info'" ng-repeat="pago in ge.planPagos">
					<td class="text-center">{{$index + 1}}</td>	
					<td class="text-center">{{pago.fechaLimite | date:"dd-MM-yyyy HH:mm:ss"}}</td>
					<td class="text-center">{{pago.numeroPago}} - {{ge.planPagos.length}}</td>
					<td class="text-right">{{pago.capital | currency}}</td>
					<td class="text-right">{{pago.interes | currency}}</td>
					<td class="text-right">{{pago.iva | currency}}</td>
					<td class="text-right">{{pago.importeRegular | currency}}</td>
				</tr>
			</tbody>
		</table>	
		<button class="btn btn-success" ng-click="ge.generarCredito()">Generar Crédito</button>							
	</div>
</div>


