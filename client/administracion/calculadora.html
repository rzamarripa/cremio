<div class="row">
	<div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
		<h1 class="alge-title txt-color-blueDark">
			<i class="fa fa-list fa-fw "></i>
				Calculadora
		</h1>
	</div>
</div>
<br>
<!-- Cabecera del perfil de  alumno seleccionado -->
<div class="row" ng-show="cal.cliente.profile != undefined">
	<div class="col-sm-12">
		<div class="well well-sm">
			<div class="row">
				<div class="col-sm-12 col-md-12 col-lg-12">
					<div class="well well-light well-sm no-margin no-padding">
						<div class="row">
							<div class="col-sm-12">
								<div id="myCarousel" class="carousel profile-carousel">
									<div class="air air-bottom-right padding-10">
										<a ng-if="currentUser.roles[0] == 'Gerente' || currentUser.roles[0] == 'Cajero' || currentUser.roles[0] == 'Verificador' " ui-sref="root.clienteDetalle({objeto_id : cal.cliente._id})" class="btn txt-color-white bg-color-teal btn-sm"><i class="fa fa-user"></i> Ir a mi perfil</a>&nbsp; 
									</div>
									<!-- <a	ui-sref="root.editarCliente({objeto_id : cd.objeto._id})" class="btn txt-color-white bg-color-pinkDark btn-sm" ng-if="currentUser.roles[0] == 'Gerente' || currentUser.roles[0] == 'Cajero'">
	 										<i class="fa fa-pencil"></i> Modificar
	 								</a>  -->
									<div class="air air-top-left padding-10">
										<h4 class="txt-color-white font-md"><i class="fa fa-calendar"></i>&nbsp;&nbsp;{{cal.fechaActual | date:'dd-MM-yyyy'}}</h4>
									</div>
									<ol class="carousel-indicators">
									</ol>
									<div class="carousel-inner">
										<div class="item active">
											<img src="img/demo/s1.jpg" alt="" style="width:100%">
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-12">
								<div class="row">
									<div class="col-sm-2 profile-pic" style="text-align:left;width:initial;">
										<img style="max-width:200px;" src="{{cal.tieneFoto(cal.cliente.profile.sexo, cal.cliente.profile.foto)}}" >
									</div>
									<div class="col-sm-6">
										<h1>{{cal.cliente.profile.nombre}} <span class="semi-bold">{{cal.cliente.profile.apellidoPaterno}} {{cal.cliente.profile.apellidoMaterno}}</span>
										
										<small> (Cliente)</small></h1>
										<ul class="list-unstyled">
											<li>
												<p class="text-muted">
													<i class="fa fa-key fa-lg"></i>&nbsp;&nbsp;
													<span class="txt-color-darken">
														<strong>{{cal.cliente.profile.username}}</strong>
													</span>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-phone fa-lg"></i>&nbsp;&nbsp;<span class="txt-color-darken">{{cal.cliente.profile.telefono}}</span>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-envelope fa-lg"></i>&nbsp;&nbsp;<a href="mailto:{{cal.cliente.profile.correo}}">{{cal.cliente.profile.correo}}</a>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-birthday-cake fa-lg"></i>&nbsp;&nbsp;<span class="txt-color-darken">{{cal.cliente.profile.fechaNacimiento | date:"dd-MM-yyyy"}}</span>
												</p>
											</li>
											<li>
												<p class="text-muted">
													<i class="fa fa-calendar fa-lg"></i>&nbsp;&nbsp;<span class="txt-color-darken">{{cal.objeto.profile.fechaCreacion | date:"dd-MM-yyyy"}}(Fecha de alta)</span>
												</p>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm-12">
					<form name="formNuevoCredito" class="form-horizontal" role="form" novalidate>
				  	<div class="well">	    
					  	<div class="row">
					  		<div class="col-sm-12">
					  			<div class="alert alert-info">
					  			 <p><i class="fa-fw fa fa-info"></i> Para <strong>crear un nuevo crédito</strong> es importante que pongamos la información correcta.</p>
					  			 <p><strong>Revisar bien los datos.</strong></p>
					  			</div>
					  		</div>
					  	</div>
					    <div class="row">
						    <div class="col-sm-4" valida>
						    	<label>Tipo de crédito *</label>
						    	<select name="tipoCreditoNuevo" class="form-control" ng-model="cal.credito.tipoCredito_id" required="">
							    	<option value="{{tipoCredito._id}}" ng-repeat="tipoCredito in cal.tiposCredito">{{tipoCredito.nombre}}</option>
						    	</select>
					    	</div>
					    	<div class="col-sm-4" valida>
						    	<label>Periodo de pago *</label>
						    	<select name="periodoCreditoNuevo" class="form-control" ng-model="cal.credito.periodoPago" required="">
							    	<option value="Semanal">Semanal</option>
							    	<option value="Quincenal">Quincenal</option>
							    	<option value="Mensual">Mensual</option>
						    	</select>
					    	</div>									    	
					    	<div class="col-sm-4" valida>					    
						    	<label>Duración (Meses) *</label>
						    	<input name="duracionMesesCreditoNuevo" type="number" class="form-control" placeholder="Duración en Meses" ng-model="cal.credito.duracionMeses" required="">
					    	</div>									    	
					    </div>
					    <div class="row">
					    	<div class="col-sm-2" valida>
						    	<label>Capital Solicitado *</label>
						    	<input name="capitalSolicitadoCreditoNuevo" type="number" class="form-control" placeholder="Capital Solicitado" ng-model="cal.credito.capitalSolicitado" required="">
					    	</div>		
					    	<div class="col-sm-2">					    
						    	<label>Requiere Verificación</label>
						    	<input name="requiereVerificacionCreditoNuevo" type="checkbox" class="form-control" ng-model="cal.credito.requiereVerificacion">
					    	</div>
					    	<div class="col-sm-2" valida>
						    	<label>Fecha Verificación</label>
						    	<input name="fechaVerificacion" date-time format="dd-MM-yyyy" class="form-control" view="date" max-view="year" min-view="date" ng-model="cal.credito.fechaVerificacion" ng-disabled="!cal.credito.requiereVerificacion" />
					    	</div>
								<div class="col-sm-2" valida>
						    	<label>Horario</label>
						    	<select name="horario" class="form-control" ng-model="cal.credito.turno" ng-disabled="!cal.credito.requiereVerificacion">
							    	<option value="mañana">Mañana</option>
							    	<option value="tarde">Tarde</option>
						    	</select>
					    	</div>
					    </div>
						</div>
						
						<h4>Avales</h4>			
						<div class="well">	    
							<div class="row">
								<div class="col-sm-8"> 
									<!--<form class="header-search pull-right">
								    <div class="form-group" style="width: 800px;">-->
											<div ng-include=" 'client/planPagos/generadorPlan/_buscarPersona.html' "></div>
								  <!--  </div>	    
									</form>-->
								</div>
							</div>
					    <div class="row">
					    	<div class="col-sm-3"> 					    
						    	<label>Nombre</label>
						    	<input name="nombreAval" type="text" class="form-control" placeholder="Nombre" ng-model="cal.aval.nombre">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Apellido Paterno</label>
						    	<input name="apellidoPaternoAval" type="text" class="form-control" placeholder="Apellido Paterno" ng-model="cal.aval.apellidoPaterno">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Apellido Materno</label>
						    	<input name="apellidoMaternoAval" type="text" class="form-control" placeholder="Apellido Materno" ng-model="cal.aval.apellidoMaterno">
					    	</div>
					    	<div class="col-sm-3"> 					    
						    	<label>Estado Civil</label>
						    	<input name="estadoCivil" type="text" class="form-control" placeholder="Estado Civil" ng-model="cal.aval.estadoCivil">
					    	</div>
					    </div>
					    <div class="row">	
						    <div class="col-sm-3"> 					    
						    	<label>Ocupación</label>
						    	<input name="ocupacion" type="text" class="form-control" placeholder="Ocupación" ng-model="cal.aval.ocupacion">
					    	</div>
						    <div class="col-sm-4">					    
						    	<label>Dirección</label>
						    	<input name="direccion" type="text" class="form-control" placeholder="Dirección" ng-model="cal.aval.direccion">
					    	</div>
					    	<div class="col-sm-3">					    
						    	<label>Empresa</label>
						    	<input name="empresa" type="text" class="form-control" placeholder="Empresa" ng-model="cal.aval.empresa">
					    	</div>
					    	<div class="col-sm-2">					    
						    	<label>Puesto</label>
						    	<input name="puesto" type="text" class="form-control" placeholder="Puesto" ng-model="cal.aval.puesto">
					    	</div>
					    	
					    </div>
					    <div class="row">	
						    <div class="col-sm-2">					    
						    	<label>Antiguedad</label>
						    	<input name="antiguedad" type="text" class="form-control" placeholder="Antiguedad" ng-model="cal.aval.antiguedad">
					    	</div>
						    <div class="col-sm-4">					    
						    	<label>Dirección Empresa</label>
						    	<input name="direccionEmpresa" type="text" class="form-control" placeholder="Dirección Empresa" ng-model="cal.aval.direccionEmpresa">
					    	</div>
					    	<div class="col-sm-4">					    
						    	<label>Parentezco</label>
						    	<input name="parentezco" type="text" class="form-control" placeholder="Parentezco" ng-model="cal.aval.parentezco">
					    	</div>
					    	<div class="col-sm-2">					    
						    	<label>Tiempo de Conocerlo</label>
						    	<input name="tiempoConocerlo" type="text" class="form-control" placeholder="Tiempo en Conocerlo" ng-model="cal.aval.tiempoConocerlo">
					    	</div>
					    	<!--<input type="hidden" name="aval_id" ng-model="cal.aval._id" value="">-->
					    </div>
					    <div class="row">		
					    	<div class="col-sm-3">
							   	<input type="button" ng-click="cal.insertarAval()" value="Agregar" ng-show="cal.actionAval" class="btn btn-primary"> 	
							   	<input type="button" ng-click="cal.borrarReferencia()" value="Quitar Referenciado" ng-show="cal.aval.persona_id" class="btn btn-warning">
							   	<input type="button" ng-click="cal.actualizarAval(cal.aval)" value="Actualizar" ng-show="!cal.actionAval" class="btn btn-primary">
							   	<input type="button" ng-click="cal.cancelarAval()" value="Cancelar" ng-show="!cal.actionAval" class="btn btn-danger">	   				
								</div>
					    </div>
					    <br/>
					    <div class="row">
								<div class="col-sm-12">
									<table class="table table-bordered">
										<thead>
											<tr>
												<th width="5%">Número</th>
												<th width="15%">Nombre</th>
												<th width="5%">Estado Civil</th>
												<th width="5%">Ocupación</th>
												<th width="15%">Dirección</th>
												<th width="10%">Empresa</th>
												<th width="5%">Puesto</th>
												<th width="5%">Antiguedad</th>
												<th width="15%">Dirección Empresa</th>
												<th width="10%">Parentezco</th>
												<th width="10%">Tiempo Conocerlo</th>
												<th width="5%">Quitar</th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="aval in cal.avales">
												<td>{{aval.num}}</td>
												<td>{{aval.nombre}}</td>
												<td>{{aval.estadoCivil}}</td>
												<td>{{aval.ocupacion}}</td>
												<td>{{aval.direccion}}</td>
												<td>{{aval.empresa}}</td>
												<td>{{aval.puesto}}</td>
												<td>{{aval.antiguedad}}</td>
												<td>{{aval.direccionEmpresa}}</td>
												<td>{{aval.parentezco}}</td>
												<td>{{aval.tiempoConocerlo}}</td>
												<td>
														<a href="#" ng-click="cal.quitarAval(aval.num)"><i class="fa fa-trash"></i></a>
														<a href="#" ng-click="cal.editarAval(aval)"><i class="fa fa-pencil"></i></a>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
						
												
						<h4>Garantias</h4>
						<div class="well">	    
							<div class="row">
								<div class="col-sm-4" valida>
							    	<label>Tipo de garantía</label>
							    	<select name="horario" class="form-control" ng-model="cal.credito.tipoGarantia">
								    	<option value="general">General o inmobiliaria</option>
								    	<option value="mobiliaria">Mobiliaria</option>
							    	</select>
						    </div>
							</div>
							
							
							<div  ng-if="cal.credito.tipoGarantia == 'mobiliaria'">
								
								<div class="row">
									<div class="col-sm-4">
										<div class="checkbox"> 					    
								    	<label><input name="esVehiculo" type="checkbox" ng-model="cal.garantia.esVehiculo">Es Vehículo</label>
							    	</div>
									</div>
								</div>
						    <div class="row">
						    	<div class="col-sm-4"> 					    
							    	<label>Tipo</label>
							    	<input name="tipo" type="text" class="form-control" placeholder="tipo" ng-model="cal.garantia.tipo">
						    	</div>
						    	<div class="col-sm-4"> 					    
							    	<label>Marca</label>
							    	<input name="marca" type="text" class="form-control" placeholder="Marca" ng-model="cal.garantia.marca">
						    	</div>
						    	<div class="col-sm-4"> 					    
							    	<label>Modelo</label>
							    	<input name="modelo" type="text" class="form-control" placeholder="Modelo" ng-model="cal.garantia.modelo">
						    	</div>
						    </div>
						    <div class="row">	
							    <div class="col-sm-4">					    
							    	<label>Serie</label>
							    	<input name="serie" type="text" class="form-control" placeholder="Serie" ng-model="cal.garantia.serie">
						    	</div>
						    	<div class="col-sm-4">					    
							    	<label>Color</label>
							    	<input name="color" type="text" class="form-control" placeholder="Color" ng-model="cal.garantia.color">
						    	</div>
						    	<div class="col-sm-4">					    
							    	<label>Estado Actual</label>
							    	<input name="estadoActual" type="text" class="form-control" placeholder="Estado Actual" ng-model="cal.garantia.estadoActual">
						    	</div>
						    </div>
						    <div class="row">		
						    	<div class="col-sm-3">
								   	<input type="button" ng-click="cal.insertarGarantia(cal.credito.tipoGarantia)" value="Agregar" ng-show="cal.actionGarantia" class="btn btn-primary"> 	
								   	<input type="button" ng-click="cal.actualizarGarantia(cal.credito.tipoGarantia, cal.garantia)" value="Actualizar" ng-show="!cal.actionGarantia" class="btn btn-primary">
								   	<input type="button" ng-click="cal.cancelarGarantia(cal.credito.tipoGarantia)" value="Cancelar" ng-show="!cal.actionGarantia" class="btn btn-danger">	   				
									</div>
						    </div>
						    <br/>
						    <div class="row">
									<div class="col-sm-12">
										<table class="table table-bordered">
											<thead>
												<tr>
													<th width="5%">Número</th>
													<th width="15%">Tipo</th>
													<th width="15%">Marca</th>
													<th width="15%">Modelo</th>
													<th width="15%">Serie</th>
													<th width="15%">Color</th>
													<th width="15%">Estado Actual</th>
													<th width="5%">Acción</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="garantia in cal.garantias">
													<td>{{garantia.num}}</td>
													<td>{{garantia.tipo}}</td>
													<td>{{garantia.marca}}</td>
													<td>{{garantia.modelo}}</td>
													<td>{{garantia.serie}}</td>
													<td>{{garantia.color}}</td>
													<td>{{garantia.estadoActual}}</td>
													<td>
															<a href="#" ng-click="cal.quitarGarantia(cal.credito.tipoGarantia, garantia.num)"><i class="fa fa-trash"></i></a>
															<a href="#" ng-click="cal.editarGarantia(cal.credito.tipoGarantia, garantia)"><i class="fa fa-pencil"></i></a>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							
							<div  ng-if="cal.credito.tipoGarantia == 'general'">
								<div class="row">
							    	<div class="col-sm-6"> 					    
											  <label>Descripción:</label>
											  <textarea class="form-control" rows="5"  cols="10" ng-model="cal.garantia.descripcion" name="descripcion"></textarea>
							    	</div>
							    	<div class="col-sm-4"> 					    
								    	<label>Valor estimado:</label>
								    	<input name="valorEstimado" type="number" class="form-control" placeholder="Valor Estimado" ng-model="cal.garantia.valorEstimado">
							    	</div>
								</div>
								<div class="row">
									<div class="col-sm-12">
										<table class="table table-bordered">
											<thead>
												<tr>
													<th width="5%">Número</th>
													<th width="15%">Descripción</th>
													<th width="15%">Valor estimado</th>
													<th width="5%">Acción</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="garantia in cal.garantiasGeneral">
													<td>{{garantia.num}}</td>
													<td>{{garantia.descripcion}}</td>
													<td>{{garantia.valorEstimado}}</td>
													<td>
															<a href="#" ng-click="cal.quitarGarantia(cal.credito.tipoGarantia, garantia.num)"><i class="fa fa-trash"></i></a>
															<a href="#" ng-click="cal.editarGarantia(cal.credito.tipoGarantia, garantia)"><i class="fa fa-pencil"></i></a>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
								<div class="row">		
						    	<div class="col-sm-3">
								   	<input type="button" ng-click="cal.insertarGarantia(cal.credito.tipoGarantia)" value="Agregar" ng-show="cal.actionGarantia" class="btn btn-primary"> 	
								   	<input type="button" ng-click="cal.actualizarGarantia(cal.credito.tipoGarantia, cal.garantia)" value="Actualizar" ng-show="!cal.actionGarantia" class="btn btn-primary">
								   	<input type="button" ng-click="cal.cancelarGarantia(cal.credito.tipoGarantia)" value="Cancelar" ng-show="!cal.actionGarantia" class="btn btn-danger">
									</div>
						    </div>
							</div>		 
						
						
						
						</div> <!--Fin del wel-->
						<div class="row">
							<div class="col-sm-12">
								<button class="btn btn-info" ng-click="cal.generarPlanPagos(cal.credito, formNuevoCredito)" valida-form formulario="formNuevoCredito">Calcular Plan de Pagos</button>
							</div>
						</div>	  
				  </form>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row" >
	<div class="col-sm-12" >
	<div id="print" > 
		<table class="table table-striped table-bordered table-condensed font-xs">
			<caption>
				<h4>Plan Nuevo</h4>
			</caption>
			<thead class="thead">
				<tr>
					<th class="text-center" width="5%">No.</th>
					<th class="text-center" width="20%">Fecha de Pago</th>
					<th class="text-center" width="15%">Pago</th>
					<th class="text-center" width="10%">Capital</th>
					<th class="text-center" width="10%">Interes</th>
					<th class="text-center" width="10%">Seguro</th>
					<th class="text-center" width="10%">IVA</th>
					<th class="text-center" width="10%">Importe total</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-class="( pago.estatus == 1 ) ? 'success' : ( pago.fecha < cal.fechaActual && pago.estatus == 0 ) ? 'warning' : ( pago.estatus == 2 ) ? 'danger' : 'info'" ng-repeat="pago in cal.planPagos">
					<td class="text-center">{{$index + 1}}</td>	
					<td class="text-center">{{pago.fechaLimite | date:"dd-MM-yyyy"}}</td>
					<td class="text-center">{{pago.numeroPago}} - {{cal.planPagos.length}}</td>
					<td class="text-right">{{pago.capital | currency}}</td>
					<td class="text-right">{{pago.interes | currency}}</td>
					<td class="text-right">{{pago.seguro | currency}}</td>
					<td class="text-right">{{pago.iva | currency}}</td>
					<td class="text-right">{{pago.importeRegular | currency}}</td>
				</tr>
			</tbody>
		</table>
		</div>

		<button class="btn btn-success" ng-click="cal.generarCredito()">Guardar Solicitud de Crédito</button>
	</div>
</div>


